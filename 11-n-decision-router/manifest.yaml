name: n-decision-router
version: 2.0.0
description: Decision router agent with 4 routing paths using v3.0.1 patterns
graphs:
- name: main
  entry_node: analyze_query
  nodes:
  - id: analyze_query
    kind: router
    label: Decision Router
    router_ref: decision_router
  - id: data_quality_exec
    kind: tool
    label: Execute Data Quality
    tool_ref: data_quality_tool
    config: {}
  - id: growth_experiment_exec
    kind: tool
    label: Execute Growth Experiment
    tool_ref: growth_experiment_tool
    config: {}
  - id: customer_support_exec
    kind: tool
    label: Execute Customer Support
    tool_ref: customer_support_tool
    config: {}
  - id: reporting_exec
    kind: tool
    label: Execute Reporting
    tool_ref: reporting_tool
    config: {}
  - id: format_response
    kind: router
    label: Format Response
    router_ref: formatter_router
  edges:
  - from_node: analyze_query
    to_node: data_quality_exec
    condition:
      route: "data_quality"
  - from_node: data_quality_exec
    to_node: format_response
  - from_node: analyze_query
    to_node: growth_experiment_exec
    condition:
      route: "growth_experiment"
  - from_node: growth_experiment_exec
    to_node: format_response
  - from_node: analyze_query
    to_node: customer_support_exec
    condition:
      route: "customer_support"
  - from_node: customer_support_exec
    to_node: format_response
  - from_node: analyze_query
    to_node: reporting_exec
    condition:
      route: "reporting"
  - from_node: reporting_exec
    to_node: format_response
tools:
- name: data_quality_tool
  description: Detect data anomalies and quality issues
  protocol: mcp
  config:
    command: mcp-data-quality
    args:
    - --mode
    - anomaly
- name: growth_experiment_tool
  description: Run A/B tests and growth experiments
  protocol: mcp
  config:
    command: mcp-growth-experiments
    args:
    - --llm
    - local://qwen3
- name: customer_support_tool
  description: Handle customer support requests and triage
  protocol: mcp
  config:
    command: mcp-support
    args:
    - --kb
    - /data/kb.sqlite
- name: reporting_tool
  description: Generate reports and KPI summaries
  protocol: mcp
  config:
    command: mcp-reporting
    args:
    - --metrics
    - weekly
routers:
- name: decision_router
  strategy: llm
  system_message: |
    You are the routing coordinator. Classify the user's request into one of:
    - data_quality
    - growth_experiment
    - customer_support
    - reporting
    
    Respond with ONLY the category name (one word).
  default_model: "ollama://qwen3:8b"
- name: formatter_router
  strategy: llm
  system_message: |
    You are a response formatter. Summarize the tool output clearly for the user.
    
    Make it concise, actionable, and easy to understand.
  default_model: "ollama://qwen3:8b"
policies: []
